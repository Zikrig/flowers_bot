# Руководство администратора

## Настройка

1. **Добавьте ваш Telegram ID в `.env` файл:**
   ```env
   ADMIN_IDS=ваш_telegram_id,id_второго_админа
   ```
   
   Чтобы узнать свой ID, напишите боту [@userinfobot](https://t.me/userinfobot)

2. **Начните диалог с ботом:**
   - Найдите вашего бота в Telegram
   - Отправьте команду `/start`
   - Это необходимо, чтобы бот мог отправлять вам уведомления

## Работа с заказами

### 1. Подтверждение оплаты

Когда клиент отправляет квитанцию об оплате:

1. **Вы получите уведомление** с:
   - Фото квитанции об оплате
   - Информацией о заказе (номер, ФИО, сумма, букеты, дата самовывоза)
   - Кнопками для действий

2. **Проверьте оплату:**
   - Проверьте, что деньги поступили на счет
   - Сравните сумму в квитанции с суммой заказа

3. **Подтвердите или отклоните:**
   - Нажмите **"✅ Подтвердить оплату"** — если оплата подтверждена
   - Нажмите **"❌ Отклонить"** — если оплата не подтверждена

4. **После подтверждения:**
   - Заказ автоматически добавляется в Google Sheets
   - Создается бланк заказа (Excel файл)
   - Клиент получает подтверждение с номером заказа

### 2. Уведомления об отмене заказов

Когда клиент отменяет оплаченный заказ:

1. **Вы получите уведомление** с:
   - Номером заказа
   - Номером карты для возврата
   - Суммой возврата
   - ФИО клиента

2. **Выполните возврат средств** на указанную карту в течение 24 часов

### 3. Просмотр всех заказов

Используйте команды бота для просмотра заказов:

- `/admin_orders` — показать все заказы
- `/admin_orders_pending` — показать заказы, ожидающие оплаты
- `/admin_orders_paid` — показать оплаченные заказы
- `/admin_orders_today` — показать заказы на сегодня

### 4. Изменение статуса заказа

- `/admin_order <номер>` — показать информацию о конкретном заказе
- Можно изменить статус заказа через кнопки

## Команды администратора

| Команда | Описание |
|---------|----------|
| `/admin_orders` | Показать все заказы |
| `/admin_orders_pending` | Заказы, ожидающие оплаты |
| `/admin_orders_paid` | Оплаченные заказы |
| `/admin_orders_today` | Заказы на сегодня |
| `/admin_order <номер>` | Информация о заказе |
| `/admin_stats` | Статистика заказов |

## Google Sheets

После подтверждения оплаты заказ автоматически добавляется в Google таблицу со следующими данными:

- Статус заказа
- Номер заказа
- Дата и время самовывоза
- ФИО клиента
- Ник в Telegram
- Варианты букетов
- Количество тюльпанов и букетов
- Сумма заказа
- Статус оплаты
- Дата создания
- Номер карты для возврата (если есть)

## Бланки заказов

После подтверждения оплаты автоматически создается Excel файл с бланком заказа в папке `orders/`.

Файл содержит:
- Номер заказа
- Варианты букетов
- Количество тюльпанов и букетов
- Дату и время самовывоза

## Автоматические функции

1. **Автоматическая отмена неоплаченных заказов:**
   - Если оплата не поступила в течение 24 часов, заказ автоматически отменяется
   - Клиент получает уведомление об отмене

2. **Проверка возможности отмены:**
   - Клиент может отменить заказ только если до самовывоза осталось более 48 часов

## Часто задаваемые вопросы

**Q: Как добавить нового администратора?**
A: Добавьте его Telegram ID в файл `.env` в переменную `ADMIN_IDS` через запятую.

**Q: Где хранятся данные заказов?**
A: Локально в файле `data/orders.json` и в Google Sheets после подтверждения оплаты.

**Q: Как посмотреть все заказы?**
A: Используйте команду `/admin_orders` или откройте Google таблицу.

**Q: Что делать, если клиент отменил заказ?**
A: Вы получите уведомление с номером карты. Верните средства в течение 24 часов.

**Q: Как изменить статус заказа вручную?**
A: Используйте команду `/admin_order <номер>` и кнопки для изменения статуса.



